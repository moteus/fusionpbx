<context name="page.{v_context}">
	<extension name="page-extension-attr" number="" continue="false" app_uuid="1b224444-de8b-448d-b2d1-19feaac3effa">
		<condition field="destination_number" expression="^page_add_begin$" break="on-true">
			<action application="set" data="api_result=${conference(${page_extension} unmute ${conference_member_id} quiet)}"/>
			<action application="bind_digit_action" data="page-xfer,*0,api:lua,transfer2.lua ${uuid} page_enter_number::XML::page.${domain_name} page_enter_to::XML::page.${domain_name}"/>
			<action application="bind_digit_action" data="page-xfer,##,api:lua,transfer2.lua ${uuid} page_enter_number::XML::page.${domain_name} ::KILL::"/>
			<action application="bind_digit_action" data="page-xfer,*#,api:lua,transfer2.lua ${uuid} page_add_end::XML::page.${domain_name} ::KILL::"/>
			<action application="bind_digit_action" data="page,*#,exec:execute_extension,page_add_begin XML page.${domain_name}"/>
			<action application="bind_digit_action" data="none,NONE,api:sleep,1"/>
			<action application="set" data="continue_on_fail=true"/>
			<action application="transfer" data="page_enter_number XML page.${domain_name}"/>
		</condition>
		<condition field="destination_number" expression="^page_add_end$" break="on-true">
			<action application="digit_action_set_realm" data="page"/>
			<action application="set" data="api_result=${conference(${page_extension} mute ${conference_member_id})}"/>
			<action application="conference" data="${page_extension}@page"/>
		</condition>
		<condition field="destination_number" expression="^page_enter_number$" break="on-true">
			<action application="digit_action_set_realm" data="none"/>
			<action application="read" data="2 11 'tone_stream://%(10000,0,350,440)' target_num 30000 #"/>
			<action application="execute_extension" data="page_bridge_${target_num} XML page.${domain_name}"/>
		</condition>
		<condition field="destination_number" expression="^page_bridge_$" break="on-true">
			<action application="execute_extension" data="page_add_end  XML page.${domain_name}"/>
		</condition>
		<condition field="destination_number" expression="^page_bridge_\*$" break="on-true">
			<action application="execute_extension" data="page_add_end XML page.${domain_name}"/>
		</condition>
		<condition field="destination_number" expression="^page_bridge_(\d{2,7})$" break="on-true">
			<action application="digit_action_set_realm" data="page-xfer"/>
			<action application="bridge" data="{page_extension=${page_extension},transfer_after_bridge=page_enter_to:XML:page.${domain_name}}user/$1@${domain_name}"/>
			<action application="execute_extension" data="page_enter_number  XML page.${domain_name}"/>
		</condition>
		<condition field="destination_number" expression="^page_bridge_" break="on-true">
			<action application="playback" data="voicemail/vm-that_was_an_invalid_ext.wav"/>
			<action application="execute_extension" data="page_enter_number XML page.${domain_name}"/>
		</condition>
		<condition field="destination_number" expression="^page_enter_to$" break="on-true">
			<action application="unbind_meta_app" data=""/>
			<action application="bind_digit_action" data="page,*#,exec:execute_extension,page_add_begin XML page.${domain_name}"/>
			<action application="digit_action_set_realm" data="page"/>
			<action application="answer" data=""/>
			<action application="playback" data="tone_stream://L=1;%(500, 0, 640)"/>
			<action application="conference" data="${page_extension}@page"/>
		</condition>
		<condition field="destination_number" expression="^page_xfer_from_dialplan$">
			<action application="lua" data="transfer2.lua ${uuid} page_add_begin::XML::page.${domain_name} page_enter_to::XML::page.${domain_name}"/>
		</condition>
	</extension>
</context>